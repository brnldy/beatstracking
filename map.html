{\rtf1\ansi\ansicpg1252\cocoartf2821
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\froman\fcharset0 Times-Roman;}
{\colortbl;\red255\green255\blue255;\red111\green143\blue180;\red80\green91\blue117;\red255\green255\blue255;
\red147\green179\blue121;\red119\green179\blue197;\red164\green121\blue157;}
{\*\expandedcolortbl;;\cssrgb\c50588\c63137\c75686;\cssrgb\c38824\c43529\c53333;\cssrgb\c100000\c100000\c100000;
\cssrgb\c63922\c74510\c54902;\cssrgb\c53333\c75294\c81569;\cssrgb\c70588\c55686\c67843;}
\paperw11900\paperh16840\margl1440\margr1440\vieww12000\viewh16420\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs25\fsmilli12573 \cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 <!\cf3 \strokec3 DOCTYPE html\cf2 \strokec2 >\cf4 \strokec4 \
\cf2 \strokec2 <html>\cf4 \strokec4 \
\cf2 \strokec2 <head>\cf4 \strokec4 \
    \cf2 \strokec2 <title>\cf4 \strokec4 Rastreamento de \'d4nibus\cf2 \strokec2 </title>\cf4 \strokec4 \
    \cf2 \strokec2 <script \cf5 \strokec5 src\cf2 \strokec2 ="\cf6 \strokec6 https://maps.googleapis.com/maps/api/js?key=AIzaSyC_OGD3KHFRYdTt2oQQ9vXDncoRkEoL6vw\cf2 \strokec2 "></script>\cf4 \strokec4 \
    \cf2 \strokec2 <style>\cf4 \strokec4 \
        #map \{\
            height: 100vh;\
            width: 100%;\
        \}\
    \cf2 \strokec2 </style>\cf4 \strokec4 \
\cf2 \strokec2 </head>\cf4 \strokec4 \
\cf2 \strokec2 <body>\cf4 \strokec4 \
    \cf2 \strokec2 <div \cf5 \strokec5 id\cf2 \strokec2 ="\cf6 \strokec6 map\cf2 \strokec2 "></div>\cf4 \strokec4 \
    \cf2 \strokec2 <script>\cf4 \strokec4 \
        \cf2 \strokec2 let\cf4 \strokec4  map\cf2 \strokec2 ;\cf4 \strokec4 \
        \cf2 \strokec2 let\cf4 \strokec4  marker\cf2 \strokec2 ;\cf4 \strokec4 \
\
        \cf2 \strokec2 function\cf4 \strokec4  \cf6 \strokec6 initMap\cf2 \strokec2 ()\cf4 \strokec4  \cf2 \strokec2 \{\cf4 \strokec4 \
            \cf3 \strokec3 // Coordenadas iniciais do mapa\cf4 \strokec4 \
            map \cf2 \strokec2 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \strokec6 google\cf2 \strokec2 .\cf6 \strokec6 maps\cf2 \strokec2 .\cf6 \strokec6 Map\cf2 \strokec2 (\cf4 \strokec4 document\cf2 \strokec2 .\cf6 \strokec6 getElementById\cf2 \strokec2 (\cf5 \strokec5 'map'\cf2 \strokec2 ),\cf4 \strokec4  \cf2 \strokec2 \{\cf4 \strokec4 \
                \cf2 \strokec2 center:\cf4 \strokec4  \cf2 \strokec2 \{\cf4 \strokec4  \cf2 \strokec2 lat:\cf4 \strokec4  \cf2 \strokec2 -\cf7 \strokec7 23.5505\cf2 \strokec2 ,\cf4 \strokec4  \cf2 \strokec2 lng:\cf4 \strokec4  \cf2 \strokec2 -\cf7 \strokec7 46.6333\cf4 \strokec4  \cf2 \strokec2 \},\cf4 \strokec4  \cf3 \strokec3 // Ex: S\'e3o Paulo\cf4 \strokec4 \
                \cf2 \strokec2 zoom:\cf4 \strokec4  \cf7 \strokec7 14\cf4 \strokec4 \
            \cf2 \strokec2 \});\cf4 \strokec4 \
\
            marker \cf2 \strokec2 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \strokec6 google\cf2 \strokec2 .\cf6 \strokec6 maps\cf2 \strokec2 .\cf6 \strokec6 Marker\cf2 \strokec2 (\{\cf4 \strokec4 \
                \cf2 \strokec2 position:\cf4 \strokec4  \cf2 \strokec2 \{\cf4 \strokec4  \cf2 \strokec2 lat:\cf4 \strokec4  \cf2 \strokec2 -\cf7 \strokec7 23.5505\cf2 \strokec2 ,\cf4 \strokec4  \cf2 \strokec2 lng:\cf4 \strokec4  \cf2 \strokec2 -\cf7 \strokec7 46.6333\cf4 \strokec4  \cf2 \strokec2 \},\cf4 \strokec4 \
                \cf2 \strokec2 map:\cf4 \strokec4  map\cf2 \strokec2 ,\cf4 \strokec4 \
                \cf2 \strokec2 title:\cf4 \strokec4  \cf5 \strokec5 "\'d4nibus"\cf4 \strokec4 \
            \cf2 \strokec2 \});\cf4 \strokec4 \
\
            \cf3 \strokec3 // Atualiza a posi\'e7\'e3o do \'f4nibus a cada 5 segundos\cf4 \strokec4 \
            \cf6 \strokec6 setInterval\cf2 \strokec2 (\cf4 \strokec4 updateBusLocation\cf2 \strokec2 ,\cf4 \strokec4  \cf7 \strokec7 5000\cf2 \strokec2 );\cf4 \strokec4 \
        \cf2 \strokec2 \}\cf4 \strokec4 \
\
        \cf2 \strokec2 async\cf4 \strokec4  \cf2 \strokec2 function\cf4 \strokec4  \cf6 \strokec6 updateBusLocation\cf2 \strokec2 ()\cf4 \strokec4  \cf2 \strokec2 \{\cf4 \strokec4 \
            \cf2 \strokec2 const\cf4 \strokec4  response \cf2 \strokec2 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  \cf6 \strokec6 fetch\cf2 \strokec2 (\cf5 \strokec5 "https://script.google.com/macros/s/AKfycbwqALnfTBFUG2kmdmY_iDfp_1GYkSmyROF8q9yIlyZluxN47rc9MDc050FVXHGtacRS/exec"\cf2 \strokec2 );\cf4 \strokec4 \
            \cf2 \strokec2 const\cf4 \strokec4  data \cf2 \strokec2 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  response\cf2 \strokec2 .\cf6 \strokec6 json\cf2 \strokec2 ();\cf4 \strokec4 \
            \cf2 \strokec2 const\cf4 \strokec4  lastRow \cf2 \strokec2 =\cf4 \strokec4  data\cf2 \strokec2 [\cf4 \strokec4 data\cf2 \strokec2 .\cf4 \strokec4 length \cf2 \strokec2 -\cf4 \strokec4  \cf7 \strokec7 1\cf2 \strokec2 ];\cf4 \strokec4  \cf3 \strokec3 // Pega a \'faltima linha (\'faltima coordenada)\cf4 \strokec4 \
\
            \cf2 \strokec2 const\cf4 \strokec4  newPos \cf2 \strokec2 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \strokec6 google\cf2 \strokec2 .\cf6 \strokec6 maps\cf2 \strokec2 .\cf6 \strokec6 LatLng\cf2 \strokec2 (\cf4 \strokec4 lastRow\cf2 \strokec2 .\cf4 \strokec4 lat\cf2 \strokec2 ,\cf4 \strokec4  lastRow\cf2 \strokec2 .\cf4 \strokec4 lng\cf2 \strokec2 );\cf4 \strokec4 \
            marker\cf2 \strokec2 .\cf6 \strokec6 setPosition\cf2 \strokec2 (\cf4 \strokec4 newPos\cf2 \strokec2 );\cf4 \strokec4 \
            map\cf2 \strokec2 .\cf6 \strokec6 setCenter\cf2 \strokec2 (\cf4 \strokec4 newPos\cf2 \strokec2 );\cf4 \strokec4 \
        \cf2 \strokec2 \}\cf4 \strokec4 \
\
        window\cf2 \strokec2 .\cf4 \strokec4 initMap \cf2 \strokec2 =\cf4 \strokec4  initMap\cf2 \strokec2 ;\cf4 \strokec4 \
    \cf2 \strokec2 </script>\cf4 \strokec4 \
\cf2 \strokec2 </body>\cf4 \strokec4 \
\cf2 \strokec2 </html>\cf4 \strokec4 \
}